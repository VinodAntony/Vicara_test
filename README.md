# Vicara_test

## 1. Initial Dataset and Training:

-> The data is generated randomly using numpy, math and the random modules.

-> The generated data along with the output target classes are passed to an estimator (Gaussian Naieve Bayes in this case) provided by the scikit-learn module.  

-> The trainer provides us with 4 parameters which are required for the next step
	- Theta
	- Sigma
	- Prior
	- Epsilon
	Values are noted and are to be used for the following structure from the CMSIS-DSP library:
```
typedef struct
{
  uint32_t vectorDimension;  /**< Dimension of vector space */
  uint32_t numberOfClasses;  /**< Number of different classes  */
  const float32_t *theta;          /**< Mean values for the Gaussians */
  const float32_t *sigma;          /**< Variances for the Gaussians */
  const float32_t *classPriors;    /**< Class prior probabilities */
  float32_t epsilon;         /**< Additive value to variances */
} arm_gaussian_naive_bayes_instance_f32;
```
-> The parameters are dumped to a txt file. The following parameters were obtained during the run: 
```
Theta =  [1.387475824161616, 0.8800443869905078, -1.6720396473828638, 0.9348414373983904, -0.07495431391816572, -2.899784943630995]
Sigma =  [0.980470340849684, 1.18166934802584, 1.0641256105658998, 1.0040083397932336, 0.917027316127453, 0.9105702307997193]
Prior =  [0.3333333333333333, 0.3333333333333333, 0.3333333333333333]
Epsilon =  4.253690631668857e-09
```

## 2. Keil MDK Setup via CubeMX
	
APB Timer clock set to 1MHz for ease of calcuation. Uses High Speed Internal Clock @16MHz and Main CPU CLock at 8MHz

![alt text](https://github.com/VinodAntony/Vicara_test/blob/main/img.png?raw=true)


Run Time Environments : 

- CMSIS Driver & CMSIS DSP
						
- Compiler > STDOUT for debug

- Device > Startup 
	
	Since we require only 10ms delay, we don't need a high frequency clock 
	
	A lower time delay (such as in nano seconds or micro seconds) will require higher clock freq. as the resolution 

	is higher. This also increases power requirements



## 3. Clock configuration/Delay

- Using HSI RC @16MHz -> PLL -> 16MHz (System Clock) -> Prescaler of 8 -> 8MHz HCLK (CPU Main Clock) -> Prescaler of 16 -> 1MHz APB Timer clock (for timer 6 and 7 , which are basic timers)

- Time delay to be generated = 10ms 

- The delay will be generated by first generating a 1ms delay and then repeating it 10 times

- To generate a 1ms delay we need the Timer frequency of 1000Hz = 1kHz <- This is the required Timer frequency

- APB Timer Clock is set at 1MHz 

- APB Timer Cock / Required Timer Frequency = Prescalar Value (optional) x ARR value (Auto-Reload Register)

- => 1MHz / 1Khz = 1000 = ARR Value (we will not use a prescaler)

- The ARR is loaded with a value of 1000

- The Timer starts when CEN bit is set in the TMRx_CR1 Register (here x = 6)

- Once the timer starts, everytime the value of the TMR CNT Register (counter) reaches 1000 (since ARR = 1000), a delay of 1ms occures.




 



	


